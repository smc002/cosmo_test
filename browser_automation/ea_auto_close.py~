import win32gui, win32api, win32con
import time, ctypes

title = 'NI Execution Adapter for IBM Rational Quality Manager'
position_close = [408, 471]

def ea_close():

    time.sleep(0.1)
    mouse_click(position_close)

def mouse_click(position):
    win = win32gui.FindWindow(None, title)
    if win == 0:
        print('window not found!')
    ctypes.windll.user32.SwitchToThisWindow(win, True)
    ctypes.windll.user32.SetFocus(win)
    position_ref = win32gui.GetWindowRect(win)

    position[0] += position_ref[0]
    position[1] += position_ref[1]
    win32api.SetCursorPos((position[0], position[1]))
    #time.sleep(0.1)
    win32api.mouse_event(win32con.MOUSEEVENTF_LEFTDOWN,0,0)
    win32api.mouse_event(win32con.MOUSEEVENTF_LEFTUP,0,0)

if __name__ == "__main__":
    ea_close()
